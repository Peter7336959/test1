[["index.html", "求職服務範例 (108~112年) 1 研究目的", " 求職服務範例 (108~112年) Yellow Apple &amp; Peter Ho 2024-05-03 1 研究目的 “這是將5年(108~112)求職服務情形進行資料收集與整理分析。主要目的有2:” 掌握就服服務資訊(由各站匯總)，如服務能量、求職人員群體特性等。 建立預測模式，由求職人員個人特質來預測是否能服務就業成功。1 “R 資料整理分析套件載入” library(tidyverse) library(readxl) library(writexl) library(stringr) library(lubridate) library(forcats) library(cowplot) library(ggpubr) library(tidyr) library(scales) library(rstatix) library(kableExtra) library(gtsummary) library(ggstats) library(kableExtra) 本資訊係於2024-04 正式收集與分析，協作人員：小玥(資料收集)、小真(概念提供)，小信(程式撰寫)，共同完成報告。↩︎ "],["研究方法.html", "2 研究方法 2.1 資料來源 2.2 分析工具與方法 2.3 資料分析主要項目", " 2 研究方法 2.1 資料來源 “資料來源：就服系統產出原始資料(excel格式)，按年按月分。” “每月有3個檔案，經手工移置目錄中，例: F:/提供主計處資料/108年/10801求職登記報表(8).” “利用R library(readxl)套件，按年按月讀取後合併” 2.1.1 資料前處理（data preprocessing） “載入資料” load(&quot;F:/提供主計處資料/X5yraw.RData&quot;) 原始求職人次 &lt;- nrow(X5y) cat(&quot;5年求職人次(原始檔案):&quot;, 原始求職人次, &quot;筆資料&quot;) ## 5年求職人次(原始檔案): 164127 筆資料 2.1.2 資料架構 “資料欄位呈現” glimpse(X5y) # 資料欄位 ## Rows: 164,127 ## Columns: 42 ## $ 登記編號 &lt;chr&gt; &quot;A51000201901000003&quot;, &quot;A51000201901000005&quot;, &quot;A5100020190… ## $ 登記日期 &lt;chr&gt; &quot;108年01月04日&quot;, &quot;108年01月04日&quot;, &quot;108年01月15日&quot;, &quot;108… ## $ 清結日期 &lt;chr&gt; &quot;108年03月05日&quot;, &quot;108年03月05日&quot;, &quot;108年03月16日&quot;, &quot;108… ## $ 求職人 &lt;chr&gt; &quot;王奕騰&quot;, &quot;吳玉珊&quot;, &quot;劉國進&quot;, &quot;劉百勝&quot;, &quot;邱春青&quot;, &quot;林美… ## $ 提供職訓使用 &lt;chr&gt; &quot;不同意&quot;, &quot;不同意&quot;, &quot;同意&quot;, &quot;同意&quot;, &quot;同意&quot;, &quot;同意&quot;, &quot;同… ## $ 身分證號碼 &lt;chr&gt; &quot;T102779247&quot;, &quot;S224312970&quot;, &quot;S120112918&quot;, &quot;S122640059&quot;, … ## $ 清結狀態 &lt;chr&gt; &quot;靜止&quot;, &quot;靜止&quot;, &quot;靜止&quot;, &quot;靜止&quot;, &quot;靜止&quot;, &quot;靜止&quot;, &quot;靜止&quot;, … ## $ 電話 &lt;chr&gt; NA, &quot;091-0973998&quot;, &quot;07-6522701&quot;, &quot;07-7315539&quot;, &quot;07-34947… ## $ 手機 &lt;chr&gt; &quot;0910806626&quot;, &quot;0903693998&quot;, NA, &quot;0981356101&quot;, &quot;097389535… ## $ 地址 &lt;chr&gt; &quot;高雄市仁武區八德南路100巷16弄1-1號&quot;, &quot;高雄市仁武區八德… ## $ 關閉人員 &lt;chr&gt; NA, NA, NA, &quot;許綺宴&quot;, &quot;許綺宴&quot;, NA, &quot;許綺宴&quot;, NA, NA, NA… ## $ 清結原因 &lt;chr&gt; &quot;系統自動關閉&quot;, &quot;系統自動關閉&quot;, &quot;系統自動關閉&quot;, &quot;公立就… ## $ 出生日期 &lt;chr&gt; &quot;41年06月18日&quot;, &quot;81年12月25日&quot;, &quot;48年06月10日&quot;, &quot;65年03… ## $ 建檔者姓名 &lt;chr&gt; &quot;張詠勛&quot;, &quot;張詠勛&quot;, &quot;張詠勛&quot;, &quot;許綺宴&quot;, &quot;許綺宴&quot;, &quot;黎玉… ## $ 希望待遇 &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;20000&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0… ## $ 個案區分 &lt;chr&gt; NA, NA, &quot;0P-公共服務; 07-一般更生受保護人; 05-中高齡者&quot;,… ## $ 外展人員 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, … ## $ 障別 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, &quot;無&quot;, NA, NA, NA, NA, NA, NA… ## $ 教育程度 &lt;chr&gt; &quot;高中&quot;, &quot;大學&quot;, &quot;高中&quot;, &quot;國中&quot;, &quot;國中&quot;, &quot;國小&quot;, &quot;高職&quot;, … ## $ 科系 &lt;chr&gt; &quot;其他&quot;, &quot;其他&quot;, &quot;其他&quot;, NA, NA, &quot;其他&quot;, &quot;其他&quot;, &quot;餐飲管… ## $ 通俗職業名稱1 &lt;chr&gt; &quot;大樓管理員&quot;, &quot;服裝設計師&quot;, &quot;環境清潔工&quot;, &quot;小客(貨)車司… ## $ 通俗職業名稱2 &lt;chr&gt; NA, NA, &quot;大樓管理員&quot;, &quot;環境清潔工&quot;, &quot;粗工&quot;, &quot;粗工&quot;, &quot;廚… ## $ 通俗職業名稱3 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, &quot;包裝作業員&quot;, &quot;產品包裝設計… ## $ 工作地點1 &lt;chr&gt; &quot;高雄市&quot;, &quot;高雄市&quot;, &quot;高雄市&quot;, &quot;高雄市&quot;, &quot;高雄市&quot;, &quot;高雄… ## $ 工作地點2 &lt;chr&gt; NA, &quot;高雄市&quot;, NA, NA, NA, NA, &quot;高雄市&quot;, &quot;高雄市&quot;, &quot;台南… ## $ 工作地點3 &lt;chr&gt; NA, &quot;高雄市&quot;, NA, NA, NA, NA, NA, &quot;高雄市&quot;, NA, NA, NA, … ## $ 電子信箱 &lt;chr&gt; NA, &quot;innocence3057@yahoo.com.tw&quot;, NA, NA, NA, NA, NA, NA… ## $ 備註 &lt;lgl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, … ## $ 兵役 &lt;chr&gt; &quot;役畢&quot;, &quot;免役&quot;, &quot;役畢&quot;, &quot;役畢&quot;, &quot;役畢&quot;, &quot;免役&quot;, &quot;役畢&quot;, … ## $ 學校名稱 &lt;chr&gt; &quot;其他/&quot;, &quot;其他/&quot;, &quot;其他/&quot;, NA, &quot;其他/&quot;, &quot;其他/&quot;, &quot;私立立… ## $ 專長 &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, &quot;心… ## $ 使用電腦能力 &lt;chr&gt; NA, &quot;文書處理/程式設計/&quot;, NA, NA, NA, NA, NA, &quot;基本操作/… ## $ 英文語言能力 &lt;chr&gt; &quot;不懂&quot;, &quot;普通&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, … ## $ 日文語言能力 &lt;chr&gt; &quot;不懂&quot;, &quot;稍懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, … ## $ 其他語言能力 &lt;chr&gt; &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, … ## $ 台灣語言能力 &lt;chr&gt; &quot;不懂&quot;, &quot;普通&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;普通&quot;, &quot;普通&quot;, &quot;不懂&quot;, … ## $ 客家語言能力 &lt;chr&gt; &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;不懂&quot;, &quot;普通&quot;, &quot;不懂&quot;, &quot;不懂&quot;, … ## $ 前次工作公司 &lt;chr&gt; NA, NA, &quot;盈甫股份有限公司&quot;, NA, &quot;高雄市衛生局&quot;, NA, NA, … ## $ 前次工作職類 &lt;chr&gt; NA, NA, &quot;技術員&quot;, NA, &quot;黎明專案-臨時人員&quot;, NA, NA, &quot;作業… ## $ 前次工作時間 &lt;chr&gt; &quot;~&quot;, &quot;~&quot;, &quot;97年07月01日~99年12月01日&quot;, &quot;~&quot;, &quot;99年02月01… ## $ 前次工作說明 &lt;chr&gt; NA, NA, &quot;沖床&quot;, NA, &quot;.&quot;, NA, NA, &quot;螺絲射出&quot;, NA, NA, NA,… ## $ 前次工作薪資 &lt;chr&gt; NA, NA, &quot;18000&quot;, NA, &quot;18300&quot;, NA, NA, &quot;18300&quot;, NA, NA, N… 2.2 分析工具與方法 “分析套件簡易說明” “預測模式說明與參考網址” 2.3 資料分析主要項目 服務能量 服務失業者比例 求職者特性 數據模式見解 —— Peter Ho 2 這是測試檔案↩︎ "],["資料清理.html", "3 資料清理", " 3 資料清理 # 日期處理 # 登記日期處理 y &lt;- as.numeric(str_sub(X5y$登記日期, start = 1, end=str_locate(X5y$登記日期,&quot;年&quot;)[[1]]-1))+1911 m &lt;- str_sub(X5y$登記日期, start=str_locate(X5y$登記日期,&quot;年&quot;)[[1]]+1, end=str_locate(X5y$登記日期,&quot;月&quot;)[[1]]-1) d &lt;- str_sub(X5y$登記日期, start=str_locate(X5y$登記日期,&quot;月&quot;)[[1]]+1, end=str_locate(X5y$登記日期,&quot;日&quot;)[[1]]-1) X5y$登記日期1 &lt;- as.Date(paste(y,m,d, sep = &quot;-&quot;)) #登記日期轉年月日星期 X5y$年 &lt;-as.character(year(X5y$登記日期1)) X5y$月 &lt;-as.character(month(X5y$登記日期1)) X5y$日 &lt;-as.character(day(X5y$登記日期1)) X5y$星期 &lt;-as.character(wday(X5y$登記日期1)) #X5y &lt;- X5y %&gt;% select(年,月,日,星期,everything()) # 清結日期處理 y &lt;- as.numeric(str_sub(X5y$清結日期, start = 1, end=str_locate(X5y$清結日期,&quot;年&quot;)[[1]]-1))+1911 m &lt;- str_sub(X5y$清結日期, start=str_locate(X5y$清結日期,&quot;年&quot;)[[1]]+1, end=str_locate(X5y$清結日期,&quot;月&quot;)[[1]]-1) d &lt;- str_sub(X5y$清結日期, start=str_locate(X5y$清結日期,&quot;月&quot;)[[1]]+1, end=str_locate(X5y$清結日期,&quot;日&quot;)[[1]]-1) X5y$清結日期1 &lt;- as.Date(paste(y,m,d, sep = &quot;-&quot;)) # 登記~結清日數 X5y$結清日數 &lt;- mday(days(X5y$清結日期1-X5y$登記日期1)) summary(X5y$結清日數) ## Min. 1st Qu. Median Mean 3rd Qu. Max. NA&#39;s ## 0.0 26.0 54.0 61.2 60.0 1420.0 3493 hist(X5y$結清日數) X5y %&gt;% count(X5y$結清日數&gt;60) %&gt;% mutate(prop=n/sum(n)) ## # A tibble: 3 × 3 ## `X5y$結清日數 &gt; 60` n prop ## &lt;lgl&gt; &lt;int&gt; &lt;dbl&gt; ## 1 FALSE 135209 0.824 ## 2 TRUE 25425 0.155 ## 3 NA 3493 0.0213 #出生日期處理 y &lt;- as.numeric(str_sub(X5y$出生日期, start = 1, end=str_locate(X5y$出生日期,&quot;年&quot;)[[1]]-1))+1911 m &lt;- str_sub(X5y$出生日期, start=str_locate(X5y$出生日期,&quot;年&quot;)[[1]]+1, end=str_locate(X5y$出生日期,&quot;月&quot;)[[1]]-1) d &lt;- str_sub(X5y$出生日期, start=str_locate(X5y$出生日期,&quot;月&quot;)[[1]]+1, end=str_locate(X5y$出生日期,&quot;日&quot;)[[1]]-1) X5y$出生日期1 &lt;- as.Date(paste(y,m,d, sep = &quot;-&quot;)) X5y$年齡 &lt;- year(X5y$登記日期1)-year(X5y$出生日期1) summary(X5y$年齡) ## Min. 1st Qu. Median Mean 3rd Qu. Max. NA&#39;s ## 13.00 25.00 36.00 37.56 48.00 103.00 2 X5y %&gt;% count(年齡&gt;75) %&gt;% mutate(prop=n/sum(n)) ## # A tibble: 3 × 3 ## `年齡 &gt; 75` n prop ## &lt;lgl&gt; &lt;int&gt; &lt;dbl&gt; ## 1 FALSE 163994 0.999 ## 2 TRUE 131 0.000798 ## 3 NA 2 0.0000122 #刪除舊欄位 #X5y &lt;- X5y %&gt;% select(-出生日期,-登記日期,-清結日期) # 前次工作時間處理 X5y$前次工作時間_起 &lt;-str_split_i(X5y$前次工作時間,&quot;~&quot;,1) X5y$前次工作時間_迄 &lt;- str_split_i(X5y$前次工作時間,&quot;~&quot;,2) #前次工作時間_起 (運算) y &lt;- str_split_i(X5y$前次工作時間_起,&quot;年&quot;,1) y[y==&quot;&quot;] &lt;- NA # 用NA取代空白 y &lt;- as.numeric(y)+1911 t1 &lt;- str_split_i(X5y$前次工作時間_起,&quot;年&quot;,2) m &lt;- str_split_i(t1,&quot;月&quot;,1) t2 &lt;- str_split_i(t1,&quot;月&quot;,2) d &lt;- str_split_i(t2,&quot;日&quot;,1) X5y$前次工作時間_起 &lt;- as.Date(ifelse(is.na(y),NA,paste(y,m,d, sep = &quot;-&quot;))) #前次工作時間_迄 (運算) y &lt;- str_split_i(X5y$前次工作時間_迄,&quot;年&quot;,1) y[y==&quot;&quot;] &lt;- NA y &lt;- as.numeric(y)+1911 t1 &lt;- str_split_i(X5y$前次工作時間_迄,&quot;年&quot;,2) m &lt;- str_split_i(t1,&quot;月&quot;,1) t2 &lt;- str_split_i(t1,&quot;月&quot;,2) d &lt;- str_split_i(t2,&quot;日&quot;,1) X5y$前次工作時間_迄 &lt;- as.Date(ifelse(is.na(y),NA,paste(y,m,d, sep = &quot;-&quot;))) #前次工作年數 X5y$前次工作年數 &lt;-round(mday(days(X5y$前次工作時間_迄-X5y$前次工作時間_起))/365,1) summary(X5y$前次工作年數) ## Min. 1st Qu. Median Mean 3rd Qu. Max. NA&#39;s ## -0.70 0.50 1.40 3.91 4.40 115.10 79518 X5y %&gt;% count(前次工作年數&gt;25) %&gt;% mutate(prop=n/sum(n)) ## # A tibble: 3 × 3 ## `前次工作年數 &gt; 25` n prop ## &lt;lgl&gt; &lt;int&gt; &lt;dbl&gt; ## 1 FALSE 83064 0.506 ## 2 TRUE 1545 0.00941 ## 3 NA 79518 0.484 #失業日數 X5y$失業日數 &lt;-round(mday(days(X5y$登記日期1-X5y$前次工作時間_迄)),0) X5y$失業年數 &lt;- round(X5y$失業日數/365,2) summary(X5y$失業年數) ## Min. 1st Qu. Median Mean 3rd Qu. Max. NA&#39;s ## -5.09 0.10 0.58 2.89 3.03 1913.36 79518 X5y %&gt;% count(失業年數&gt;25) %&gt;% mutate(prop=n/sum(n)) ## # A tibble: 3 × 3 ## `失業年數 &gt; 25` n prop ## &lt;lgl&gt; &lt;int&gt; &lt;dbl&gt; ## 1 FALSE 83808 0.511 ## 2 TRUE 801 0.00488 ## 3 NA 79518 0.484 #刪除舊欄位 #X5y &lt;- X5y %&gt;% select(-前次工作時間) #處理行政區 X5y$居住行政區 &lt;- str_sub(X5y$地址, 1, 6) #工作地點與居住行政區 #居住地點分布 F &lt;- X5y %&gt;% select(年,居住行政區) %&gt;% filter(str_detect(居住行政區, &quot;市&quot;)|str_detect(居住行政區, &quot;縣&quot;)) X5y &lt;- X5y %&gt;% filter(str_detect(居住行政區, &quot;市&quot;)|str_detect(居住行政區, &quot;縣&quot;)) %&gt;% mutate(居住市=str_sub(居住行政區,1,2)) X5y %&gt;% group_by(居住市) %&gt;% summarise(人數=n()) %&gt;% arrange(desc(人數)) %&gt;% mutate(prop = round(人數/sum(人數),3)) %&gt;% filter(prop&gt;0.001) ## # A tibble: 11 × 3 ## 居住市 人數 prop ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 高雄 152802 0.931 ## 2 屏東 3205 0.02 ## 3 台南 3006 0.018 ## 4 台中 955 0.006 ## 5 嘉義 630 0.004 ## 6 新北 613 0.004 ## 7 桃園 530 0.003 ## 8 彰化 477 0.003 ## 9 雲林 347 0.002 ## 10 台北 274 0.002 ## 11 台東 261 0.002 X5y &lt;- X5y %&gt;% mutate(居住區 = str_split_i(F$居住行政區,&quot;市&quot;,2)) X5y %&gt;% group_by(居住區) %&gt;% summarise(人數=n()) %&gt;% arrange(desc(人數)) %&gt;% mutate(prop = round(人數/sum(人數),3)) %&gt;% filter(prop&gt;0.001) ## # A tibble: 42 × 3 ## 居住區 人數 prop ## &lt;chr&gt; &lt;int&gt; &lt;dbl&gt; ## 1 鳳山區 20576 0.125 ## 2 三民區 18372 0.112 ## 3 楠梓區 12023 0.073 ## 4 左營區 10742 0.065 ## 5 前鎮區 10216 0.062 ## 6 苓雅區 8454 0.052 ## 7 小港區 7570 0.046 ## 8 大寮區 7468 0.046 ## 9 鼓山區 6274 0.038 ## 10 岡山區 5950 0.036 ## # ℹ 32 more rows #刪除舊欄位 #X5y &lt;- X5y %&gt;% select(-地址) #處理個案區分 max(str_count(X5y$個案區分, &quot;;&quot;), na.rm = T) ## [1] 7 X5y$個案區分1 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,1) X5y$個案區分2 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,2) X5y$個案區分3 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,3) X5y$個案區分4 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,4) X5y$個案區分5 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,5) X5y$個案區分6 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,6) X5y$個案區分7 &lt;- str_split_i(X5y$個案區分,&quot;;&quot;,7) X5y$身分數 &lt;- 7-(is.na(X5y$個案區分1)+ is.na(X5y$個案區分2)+ is.na(X5y$個案區分3)+ is.na(X5y$個案區分4)+ is.na(X5y$個案區分5)+ is.na(X5y$個案區分6)+ is.na(X5y$個案區分7)) #刪除不用欄位 #X5y &lt;- X5y %&gt;% select(-電話,-手機,-電子信箱,-個案區分,) #教育程度 X5y %&gt;% count(教育程度) ## # A tibble: 9 × 2 ## 教育程度 n ## &lt;chr&gt; &lt;int&gt; ## 1 其他 691 ## 2 博士 158 ## 3 國中 10881 ## 4 國小 3190 ## 5 大學 68017 ## 6 專科 18525 ## 7 碩士 5804 ## 8 高中 8826 ## 9 高職 48025 X5y$教育程度1 &lt;- ifelse(X5y$教育程度==&quot;國小&quot;|X5y$教育程度==&quot;國中&quot;,&quot;國中小&quot;, ifelse(X5y$教育程度==&quot;高職&quot;|X5y$教育程度==&quot;高中&quot;,&quot;高中職&quot;, ifelse(X5y$教育程度==&quot;大學&quot;|X5y$教育程度==&quot;大專&quot;,&quot;大專學&quot;, ifelse(X5y$教育程度==&quot;碩士&quot;|X5y$教育程度==&quot;博士&quot;,&quot;碩博士&quot;, &quot;其他&quot;)))) X5y %&gt;% count(教育程度1) ## # A tibble: 5 × 2 ## 教育程度1 n ## &lt;chr&gt; &lt;int&gt; ## 1 其他 19216 ## 2 國中小 14071 ## 3 大專學 68017 ## 4 碩博士 5962 ## 5 高中職 56851 #語言程度 X5y %&gt;% count(英文語言能力) ## # A tibble: 5 × 2 ## 英文語言能力 n ## &lt;chr&gt; &lt;int&gt; ## 1 不懂 112947 ## 2 普通 24860 ## 3 稍懂 22741 ## 4 精通 3535 ## 5 &lt;NA&gt; 34 X5y$英文能力1 &lt;- ifelse(X5y$英文語言能力==&quot;不懂&quot;,&quot;不懂&quot;, ifelse(X5y$英文語言能力==&quot;普通&quot;|X5y$英文語言能力==&quot;稍懂&quot;,&quot;尚可&quot;, ifelse(X5y$英文語言能力==&quot;精通&quot;,&quot;精通&quot;,NA))) X5y %&gt;% count(英文能力1) ## # A tibble: 4 × 2 ## 英文能力1 n ## &lt;chr&gt; &lt;int&gt; ## 1 不懂 112947 ## 2 尚可 47601 ## 3 精通 3535 ## 4 &lt;NA&gt; 34 X5y %&gt;% count(日文語言能力) ## # A tibble: 5 × 2 ## 日文語言能力 n ## &lt;chr&gt; &lt;int&gt; ## 1 不懂 152888 ## 2 普通 3042 ## 3 稍懂 7449 ## 4 精通 703 ## 5 &lt;NA&gt; 35 X5y$日文能力1 &lt;- ifelse(X5y$日文語言能力==&quot;不懂&quot;,&quot;不懂&quot;, ifelse(X5y$日文語言能力==&quot;普通&quot;|X5y$日文語言能力==&quot;稍懂&quot;,&quot;尚可&quot;, ifelse(X5y$英文語言能力==&quot;精通&quot;,&quot;精通&quot;,NA))) X5y %&gt;% count(日文能力1) ## # A tibble: 4 × 2 ## 日文能力1 n ## &lt;chr&gt; &lt;int&gt; ## 1 不懂 152888 ## 2 尚可 10491 ## 3 精通 163 ## 4 &lt;NA&gt; 575 #處理清結原因 # 原因統計 X5y %&gt;% count(清結原因) ## # A tibble: 18 × 2 ## 清結原因 n ## &lt;chr&gt; &lt;int&gt; ## 1 公立就業服務機構推薦成功 27718 ## 2 公立就業服務機構推薦成功－一般就業服務 4391 ## 3 公立就業服務機構推薦成功－一般就業服務(4人以下廠商) 360 ## 4 利用本部資訊就業-其他 30380 ## 5 利用本部資訊就業-台灣就業通 39927 ## 6 利用本部資訊就業-求才快報 4334 ## 7 利用本部資訊就業-現場徵才 1204 ## 8 利用本部資訊就業-觸控式電腦 3432 ## 9 改利用其他管道求職 6845 ## 10 暫停就業-其他 3533 ## 11 暫停就業-參加職業訓練 2307 ## 12 暫停就業-家中有事 2878 ## 13 暫停就業-準備考試/升學 4446 ## 14 求職者尚具求職需求，需持續服務 1760 ## 15 無法聯繫求職者 8593 ## 16 系統自動關閉 15442 ## 17 自行就業－其他 3074 ## 18 &lt;NA&gt; 3493 X5y$清結原因1 &lt;- NA X5y$清結原因1 &lt;- ifelse (str_detect(X5y$清結原因, &quot;推薦成功&quot;), &quot;推薦成功&quot;, ifelse (str_detect(X5y$清結原因, &quot;利用本部資訊就業&quot;), &quot;利用本部資訊就業&quot;, ifelse (str_detect(X5y$清結原因, &quot;暫停就業&quot;), &quot;暫停就業&quot;, ifelse (str_detect(X5y$清結原因, &quot;改利用其他管道&quot;), &quot;改利用其他管道&quot;, ifelse (str_detect(X5y$清結原因, &quot;系統自動關閉&quot;), &quot;系統自動關閉&quot;, ifelse (str_detect(X5y$清結原因, &quot;尚具求職需求&quot;), &quot;尚具求職需求&quot;, ifelse (str_detect(X5y$清結原因, &quot;無法聯繫&quot;), &quot;無法聯繫&quot;, ifelse (str_detect(X5y$清結原因, &quot;自行就業&quot;), &quot;自行就業&quot;,NA)))))))) X5y %&gt;% count(清結原因1) ## # A tibble: 9 × 2 ## 清結原因1 n ## &lt;chr&gt; &lt;int&gt; ## 1 利用本部資訊就業 79277 ## 2 尚具求職需求 1760 ## 3 推薦成功 32469 ## 4 改利用其他管道 6845 ## 5 暫停就業 13164 ## 6 無法聯繫 8593 ## 7 系統自動關閉 15442 ## 8 自行就業 3074 ## 9 &lt;NA&gt; 3493 #年齡分組1 #青年18-29, #青壯年30-44, #中高齡45-64, #銀髮55以上, #高齡65以上 X5y$年齡分組1 &lt;- ifelse (X5y$年齡&lt;18, &quot;少年&lt; 18&quot;, ifelse (X5y$年齡&lt;30,&quot;青年18-29&quot;, ifelse (X5y$年齡&lt;45,&quot;青壯年30-44&quot;, ifelse (X5y$年齡&lt;65,&quot;中高齡45-64&quot;, ifelse (X5y$年齡&gt;64,&quot;高齡 &gt;65&quot;,NA))))) X5y %&gt;% count(年齡分組1) ## # A tibble: 6 × 2 ## 年齡分組1 n ## &lt;chr&gt; &lt;int&gt; ## 1 中高齡45-64 48935 ## 2 少年&lt; 18 777 ## 3 青壯年30-44 51287 ## 4 青年18-29 58877 ## 5 高齡 &gt;65 4239 ## 6 &lt;NA&gt; 2 # 年齡分組2 #每5歲一級距， #15以下, #16-20, #21-25, #26-30, ..... X5y$年齡分組2 &lt;- ifelse (X5y$年齡&lt;=15, &quot;&lt;= 15&quot;, ifelse (X5y$年齡&lt;=20,&quot;16-20&quot;, ifelse (X5y$年齡&lt;=25,&quot;21-25&quot;, ifelse (X5y$年齡&lt;=30,&quot;26-30&quot;, ifelse (X5y$年齡&lt;=35,&quot;31-35&quot;, ifelse (X5y$年齡&lt;=40,&quot;36-40&quot;, ifelse (X5y$年齡&lt;=45,&quot;41-45&quot;, ifelse (X5y$年齡&lt;=50,&quot;46-50&quot;, ifelse (X5y$年齡&lt;=55,&quot;51-55&quot;, ifelse (X5y$年齡&lt;=60,&quot;56-60&quot;, ifelse (X5y$年齡&lt;=65,&quot;61-65&quot;, ifelse (X5y$年齡&gt;65,&quot;&gt; 65&quot;,NA)))))))))))) X5y %&gt;% count(年齡分組2) ## # A tibble: 13 × 2 ## 年齡分組2 n ## &lt;chr&gt; &lt;int&gt; ## 1 16-20 13577 ## 2 21-25 29658 ## 3 26-30 19900 ## 4 31-35 16311 ## 5 36-40 16958 ## 6 41-45 17852 ## 7 46-50 15856 ## 8 51-55 13845 ## 9 56-60 10844 ## 10 61-65 5944 ## 11 &lt;= 15 80 ## 12 &gt; 65 3290 ## 13 &lt;NA&gt; 2 #障別 X5y %&gt;% count(障別) ## # A tibble: 35 × 2 ## 障別 n ## &lt;chr&gt; &lt;int&gt; ## 1 上肢體障礙者 1 ## 2 上肢體障礙者;無 100 ## 3 下肢體障礙者 4 ## 4 下肢體障礙者;無 200 ## 5 先天代謝異常 1 ## 6 其他 6 ## 7 其他;無 73 ## 8 因罕見疾病而致身心功能障礙者;無 5 ## 9 多重障礙者 3 ## 10 多重障礙者;無 104 ## # ℹ 25 more rows X5y$障別1 &lt;- ifelse (str_detect(X5y$障別, &quot;上肢體障礙者&quot;), &quot;上肢體障礙者&quot;, ifelse (str_detect(X5y$障別, &quot;下肢體障礙者&quot;), &quot;下肢體障礙者&quot;, ifelse (str_detect(X5y$障別, &quot;其他&quot;), &quot;其他&quot;, ifelse (str_detect(X5y$障別, &quot;多重障礙者&quot;), &quot;多重障礙者&quot;, ifelse (str_detect(X5y$障別, &quot;罕見疾病&quot;), &quot;罕見疾病致身心障礙者&quot;, ifelse (str_detect(X5y$障別, &quot;先天代謝異常&quot;), &quot;先天代謝異常&quot;,NA)))))) X5y$希望待遇 &lt;- as.integer(X5y$希望待遇) X5y$前次工作薪資 &lt;- as.integer(X5y$前次工作薪資) #刪除重複資料 X5y &lt;- unique(X5y) #save(X5y, file = &quot;F:/提供主計處資料/X5y.RData&quot;) #162197筆 #write_xlsx(X5y,&quot;F:/提供主計處資料/X5y.xlsx&quot;) #162197筆 求職人次 &lt;- nrow(X5y) cat(&quot;5年求職人次(資料清理後):&quot;, 求職人次, &quot;筆資料&quot;) ## 5年求職人次(資料清理後): 162197 筆資料 "],["異常值處理.html", "4 異常值處理", " 4 異常值處理 #load(&quot;F:/提供主計處資料/X5y.RData&quot;) #162197筆 #姓名重複筆數與人次? A &lt;- X5y[!duplicated(X5y$求職人),] #總數162197筆，沒重複的筆數是133734筆 B &lt;- X5y[duplicated(X5y$求職人),] #重複筆數 28463 (會去掉自己1筆) B1 &lt;- B[!duplicated(B$求職人),] #重複筆數中，使不重複後筆數14555人 #故X5y中，有28463+14555筆=43018重複 C &lt;- B1 %&gt;% select(求職人) %&gt;% # 實際上確實有43018筆重複 left_join(X5y,by=&quot;求職人&quot;) D &lt;- C %&gt;% arrange(求職人) %&gt;% group_by(求職人) %&gt;% #求職人重複服務次數 summarise(服務次數=n()) E &lt;- D %&gt;% group_by(服務次數) %&gt;% summarise(人次=n()) %&gt;% mutate(prop=percent(人次/sum(人次),0.1)) # 服務次數的人數排比 ggplot(E, aes(x=服務次數, y=人次)) + geom_col() F &lt;- E %&gt;% filter(服務次數&gt;10) ggplot(F,aes(x=服務次數, y=人次)) + geom_col() #答案就是5年內有14555人重複服務(共43018筆紀錄)，服務次數排比如上 #所以， #1總資料表去掉重複者，用於分析求職者特性 133734筆-求職人檔 #2總資料表去掉重複者，用於分析服務能量 162197筆- X5y #求職人單獨檔 求職人檔 &lt;- A #服務多次名冊與人數 來2次以上求職人檔 &lt;- C cat(&quot;求職人最多接受服務次數: &quot;,max(E$服務次數)) ## 求職人最多接受服務次數: 62 cat(&quot;來2次以上人數: &quot;,nrow(來2次以上求職人檔)) ## 來2次以上人數: 43018 #資料筆數 求職人次 &lt;- nrow(X5y) 求職人數 &lt;- nrow(求職人檔) #重複人次=求職人次-求職人數 cat(&quot;求職人次:&quot;, 求職人次, &quot;; &quot;,&quot;求職人數:&quot;,求職人數,&quot;;&quot;) ## 求職人次: 162197 ; 求職人數: 133734 ; cat(&quot;重複人次 = &quot;,nrow(來2次以上求職人檔)) ## 重複人次 = 43018 #(以下不必執行) # 驗證資料唯一性與正確 # 姓名與身分證一致? #A &lt;- 求職人檔 %&gt;% group_by(求職人,身分證號碼) %&gt;% # filter(求職人==身分證號碼) #查證是否有重複姓名 #B1 &lt;- 求職人檔 %&gt;% group_by(求職人,身分證號碼) %&gt;% # filter(身分證號碼==A$身分證號碼[1]) #B2 &lt;- X5y %&gt;% group_by(求職人,身分證號碼) %&gt;% # filter(身分證號碼==A$身分證號碼[2]) #以上都是唯一，故保留，繼續往下執行 # 年齡 # Density plot with mean lines and marginal rug 求職人檔 %&gt;% ggplot(aes(x=年齡, y=as.factor(年),fill=年))+ geom_boxplot() ## Warning: Removed 2 rows containing non-finite outside the scale range ## (`stat_boxplot()`). 求職人檔 %&gt;% ggplot(aes(y=年齡))+ geom_boxplot() ## Warning: Removed 2 rows containing non-finite outside the scale range ## (`stat_boxplot()`). hist(求職人檔$年齡) #save(求職人檔, file = &quot;F:/提供主計處資料/求職人檔.RData&quot;) #133734筆 #save(來2次以上求職人檔, file = &quot;F:/提供主計處資料/來2次以上求職人檔.RData&quot;) #133734筆 #save(X5y, file = &quot;F:/提供主計處資料/X5y.RData&quot;) #162197筆 "],["服務能量求職人次與人數因為1人可能來多次.html", "5 服務能量(求職人次與人數–因為1人可能來多次)", " 5 服務能量(求職人次與人數–因為1人可能來多次) #3.1 服務能量(求職人次與人數--因為1人可能來多次)--------- #load(&quot;F:/提供主計處資料/X5y.RData&quot;) # 每日處理件數 datebreaks &lt;- seq(as.Date(&quot;2019-01-01&quot;), as.Date(&quot;2023-12-31&quot;), by = &quot;3 month&quot;) dailycase &lt;- X5y %&gt;% group_by(登記日期1,年,月,日,星期) %&gt;% summarise(count=n()) ## `summarise()` has grouped output by &#39;登記日期1&#39;, &#39;年&#39;, &#39;月&#39;, &#39;日&#39;. You can ## override using the `.groups` argument. # 計算日均與月總 d &lt;- dailycase %&gt;% group_by(年) %&gt;% #計算日處理量 summarise(每年總量=sum(count), 日數=n()) %&gt;% mutate(日平均量=round(每年總量/日數,0)) pc &lt;- ggplot(dailycase, aes(x=登記日期1, y= count,fill=年)) + geom_area(show.legend = F) + facet_grid(.~年, scales = &quot;free_x&quot;)+ scale_x_date(breaks = datebreaks,date_labels = &quot;%y/%m&quot;) + theme(axis.text.x = element_text(angle = 30, hjust = 1))+ labs(title = &quot;年度求職人次統計量圖&quot;, x=&quot;登記日期&quot;,y=&quot;求職人數&quot;, color=&quot;年&quot;)+ theme(legend.position = &quot;top&quot;)+ #主題樣式與legend位置 theme(axis.text = element_text(face=&quot;bold&quot;,size = 10, angle = 0, vjust = 0.5, hjust = 0.5), #xy-axis label size.. axis.title = element_text(face=&quot;bold&quot;,size = 15,hjust = 0.5), #xy-axis title size plot.title = element_text(face=&quot;bold&quot;,size = 18,hjust = 0.5), plot.subtitle = element_text(face=&quot;bold&quot;,size = 14,hjust = 0.5,margin = margin(t = 20)), legend.title = element_text(color=&quot;black&quot;, size=15, face=&quot;bold&quot;, hjust = 1.0), legend.text = element_text(size=15)) # 加入平均值與線及文字 pc &lt;- pc+ geom_hline(data = d, aes(yintercept = 日平均量), linetype = &quot;dashed&quot;,size =1)+ # 每天平均處理量 geom_text(data = d, aes(y=313, x=ymd(c(&quot;2019/04/01&quot;,&quot;2020/04/01&quot;,&quot;2021/04/01&quot;,&quot;2022/04/01&quot;,&quot;2023/04/01&quot;)), label = &quot;日均量&quot;),vjust =0, fontface=&quot;bold&quot;, size=4) + geom_text(data = d, aes(y=320,x = ymd(c(&quot;2019/08/01&quot;,&quot;2020/08/01&quot;,&quot;2021/08/01&quot;,&quot;2022/08/01&quot;,&quot;2023/08/01&quot;)), label = 日平均量),hjust =0, fontface=&quot;bold&quot;, size=4,color=&quot;red&quot;) + # 每月處理量 geom_text(data = d, aes(y=350,x =ymd(c(&quot;2019/04/01&quot;,&quot;2020/04/01&quot;,&quot;2021/04/01&quot;, &quot;2022/04/01&quot;,&quot;2023/04/01&quot;)), label = &quot;年量&quot;), vjust =0, fontface=&quot;bold&quot;, size=4)+ geom_text(data = d, aes(y=360,x = ymd(c(&quot;2019/08/01&quot;,&quot;2020/08/01&quot;,&quot;2021/08/01&quot;,&quot;2022/08/01&quot;,&quot;2023/08/01&quot;)), label = 每年總量), hjust =0, fontface=&quot;bold&quot;, size=4,color=&quot;red&quot;) ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ## ℹ Please use `linewidth` instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. pc ## Warning: `show.legend` must be a logical vector. # 每月處理件數 monthlycase &lt;- dailycase %&gt;% group_by(年,月) %&gt;% summarise(count=sum(count),月處理日數=n()) ## `summarise()` has grouped output by &#39;年&#39;. You can override using the `.groups` ## argument. #計算月處理量 m &lt;- monthlycase %&gt;% group_by(年) %&gt;% summarise(每年總量=sum(count), 月數=n()) %&gt;% mutate(月平均量=round(每年總量/月數,0)) pd &lt;- ggplot(monthlycase, aes(x=月, y= count, fill=年)) + geom_col(position = &quot;dodge&quot;,show.legend = F)+ theme(axis.text.x = element_text(angle = 30, hjust = 1))+ labs(title = &quot;每月求職人次統計量圖&quot;, x=&quot;申請月份&quot;,y=&quot;求職人數&quot;)+ facet_grid(.~年)+ scale_x_discrete(limits = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;,&quot;4&quot;,&quot;5&quot;,&quot;6&quot;,&quot;7&quot;,&quot;8&quot;,&quot;9&quot;,&quot;10&quot;,&quot;11&quot;,&quot;12&quot;))+ theme(axis.text = element_text(face=&quot;bold&quot;,size = 10, angle = 0, vjust = 0.5, hjust = 0.5), #xy-axis label size.. axis.title = element_text(face=&quot;bold&quot;,size = 15,hjust = 0.5), #xy-axis title size plot.title = element_text(face=&quot;bold&quot;,size = 18,hjust = 0.5), # 標題大小 plot.subtitle = element_text(face=&quot;bold&quot;,size = 14,hjust = 0.5,margin = margin(t = 20))) # 標題大小 pd &lt;- pd+ geom_hline(data=m,aes(yintercept = 月平均量),linetype = &quot;dashed&quot;,size =1, color=&quot;black&quot; )+ geom_text(data=m, aes(x=9,y = 4500,label = 月平均量), vjust =-1, fontface=&quot;bold&quot;, size=4,color=&quot;red&quot;)+ # 加上數字標籤 geom_text(data=m, aes(x=1,y = 4400,label = &quot;月均量&quot;), vjust =-1.5,hjust=0, fontface=&quot;bold&quot;, size=4) # 加上數字標籤 pd ## Warning: `show.legend` must be a logical vector. #plot_grid(pd, labels=c(&quot;圖 D&quot;)) # 每年處理件數(可略) yearlycase &lt;- monthlycase %&gt;% group_by(年) %&gt;% summarise(count=sum(count)) pe &lt;- ggplot(yearlycase, aes(x=年, y= count, fill=年)) + geom_col(position = &quot;dodge&quot;,width = 0.5, show.legend = F, alpha=0.7)+ #theme(axis.text.x = element_text(angle = 30, hjust = 1))+ labs(title = &quot;每年服務求職人次&quot;, x=&quot;年&quot;,y=&quot;求職人次&quot;)+ theme(axis.text = element_text(face=&quot;bold&quot;,size = 10, angle = 0, vjust = 0.5, hjust = 0.5), #xy-axis label size.. axis.title = element_text(face=&quot;bold&quot;,size = 15,hjust = 0.5), #xy-axis title size plot.title = element_text(face=&quot;bold&quot;,size = 18,hjust = 0.5), # 標題大小 plot.subtitle = element_text(face=&quot;bold&quot;,size = 14,hjust = 0.5,margin = margin(t = 20)))# 標題大小 pe &lt;- pe + geom_text(aes(label = count), vjust = 1.5, fontface=&quot;bold&quot;,size=4,color=&quot;red&quot;) # 加上數字標籤 pe ## Warning: `show.legend` must be a logical vector. #save(X5y, file = &quot;F:/提供主計處資料/X5y.RData&quot;) #162197筆 "],["求職人特質含因素分析.html", "6 求職人特質(含因素分析)", " 6 求職人特質(含因素分析) #load(&quot;F:/提供主計處資料/X5y.RData&quot;) #load(&quot;F:/提供主計處資料/求職人檔.RData&quot;) 求職人資料 &lt;- 求職人檔 #3.3.1 年齡分布 # boxplot and test p1 &lt;- ggboxplot(求職人資料, x = &quot;年&quot;, y = &quot;年齡&quot;, color = &quot;年&quot;) my_comparisons &lt;- list( c(&quot;2019&quot;, &quot;2020&quot;), c(&quot;2021&quot;, &quot;2022&quot;), c(&quot;2022&quot;, &quot;2023&quot;) ) p1 + stat_compare_means(comparisons = my_comparisons)+ # Add pairwise comparisons p-value stat_compare_means(label.y = 130) # Add global p-value ## Warning: Removed 2 rows containing non-finite outside the scale range ## (`stat_boxplot()`). ## Warning: Removed 2 rows containing non-finite outside the scale range ## (`stat_signif()`). ## Warning: Removed 2 rows containing non-finite outside the scale range ## (`stat_compare_means()`). # Density plot with mean lines and marginal rug hist(求職人資料$年齡) max(求職人資料$年齡, na.rm = T) ## [1] 85 #年齡分組A X5y$年齡分組1 &lt;- factor(X5y$年齡分組1, levels=c(&quot;少年&lt; 18&quot;,&quot;青年18-29&quot;, &quot;青壯年30-44&quot;,&quot;中高齡45-64&quot;,&quot;高齡 &gt;65&quot;)) library(ggstats) X5y %&gt;% filter(!is.na(年齡分組1))%&gt;% ggplot(aes(年齡分組1, fill = 年齡分組1)) + geom_bar() + geom_text(stat = &quot;count&quot;, aes(label = after_stat(count)), vjust=-0.5, position=position_dodge(width=1), size=3) + xlab(&quot;年齡分組&quot;) +ylab(&quot;人數&quot;) + geom_text(stat = &quot;prop&quot;, aes(label = percent(after_stat(prop),0.1)), vjust=2, position=position_dodge(width=1), size=3,color=&quot;darkred&quot;) + xlab(&quot;年齡分組&quot;) +ylab(&quot;人數&quot;) + ggtitle(&quot;求職人年齡分組1&quot;) #年齡分組B X5y$年齡分組2 &lt;- factor(X5y$年齡分組2, levels=c(&quot;&lt;= 15&quot;,&quot;16-20&quot;,&quot;21-25&quot;,&quot;26-30&quot;,&quot;31-35&quot;,&quot;36-40&quot;, &quot;41-45&quot;,&quot;46-50&quot;,&quot;51-55&quot;,&quot;56-60&quot;,&quot;61-65&quot;,&quot;&gt; 65&quot;)) X5y %&gt;% filter(!is.na(年齡分組2))%&gt;% ggplot(aes(年齡分組2, fill = 年齡分組2)) + geom_bar() + geom_text(stat = &quot;count&quot;, aes(label = after_stat(count)), vjust=-0.5, position=position_dodge(width=1), size=3) + xlab(&quot;年齡分組&quot;) +ylab(&quot;人數&quot;) + geom_text(stat = &quot;prop&quot;, aes(label = percent(after_stat(prop),0.1)), vjust=2, position=position_dodge(width=1), size=3,color=&quot;darkred&quot;) + xlab(&quot;年齡分組&quot;) +ylab(&quot;人數&quot;) + ggtitle(&quot;求職人年齡分組2&quot;) # 3.3.2 障別 障別 &lt;- 求職人資料 %&gt;% group_by(障別1) %&gt;% filter(!is.na(障別1))%&gt;% summarise(count=n()) 障別$障別1 &lt;- factor(障別$障別1, levels=c(&quot;上肢體障礙者&quot;,&quot;下肢體障礙者&quot;,&quot;多重障礙者&quot;, &quot;罕見疾病致身心障礙者&quot;,&quot;先天代謝異常&quot;,&quot;其他&quot;)) ggbarplot(障別, x = &quot;障別1&quot;, y = &quot;count&quot;, label = T, label.pos = &quot;in&quot;, width = 0.8,position = position_dodge(1), fill = &quot;障別1&quot;,color = &quot;white&quot;,legend=&quot;none&quot;, palette = &quot;jco&quot;, x.text.angle = 30,ylim = c(0, 200) ) #教育程度 求職人資料 %&gt;% count(教育程度) ## # A tibble: 9 × 2 ## 教育程度 n ## &lt;chr&gt; &lt;int&gt; ## 1 其他 600 ## 2 博士 126 ## 3 國中 9120 ## 4 國小 2758 ## 5 大學 55172 ## 6 專科 14963 ## 7 碩士 4667 ## 8 高中 7408 ## 9 高職 38920 教育程度 &lt;- 求職人資料 %&gt;% group_by(教育程度) %&gt;% summarise(count=n()) 教育程度$教育程度 &lt;- factor(教育程度$教育程度, levels=c(&quot;國小&quot;,&quot;國中&quot;,&quot;高職&quot;,&quot;高中&quot;,&quot;專科&quot;,&quot;大學&quot;, &quot;碩士&quot;,&quot;博士&quot;,&quot;其他&quot;)) ggbarplot(教育程度, x = &quot;教育程度&quot;, y = &quot;count&quot;, label = T, label.pos = &quot;in&quot;, width = 0.8,position = position_dodge(1), fill = &quot;教育程度&quot;,color = &quot;white&quot;,legend=&quot;none&quot;, palette = &quot;jco&quot;, x.text.angle = 30 ) #語言能力 求職人資料 %&gt;% count(英文語言能力) ## # A tibble: 5 × 2 ## 英文語言能力 n ## &lt;chr&gt; &lt;int&gt; ## 1 不懂 92573 ## 2 普通 20263 ## 3 稍懂 18019 ## 4 精通 2851 ## 5 &lt;NA&gt; 28 求職人資料 %&gt;% count(日文語言能力) ## # A tibble: 5 × 2 ## 日文語言能力 n ## &lt;chr&gt; &lt;int&gt; ## 1 不懂 124804 ## 2 普通 2467 ## 3 稍懂 5872 ## 4 精通 562 ## 5 &lt;NA&gt; 29 語言能力1 &lt;- 求職人資料 %&gt;% group_by(英文語言能力) %&gt;% summarise(英文=n()) %&gt;% rename(語言能力=英文語言能力) 語言能力2 &lt;- 求職人資料 %&gt;% group_by(日文語言能力) %&gt;% summarise(日文=n())%&gt;% rename(語言能力=日文語言能力) 語言能力=cbind(語言能力1,語言能力2[,2]) ggbarplot(語言能力, x = &quot;語言能力&quot;, y = &quot;英文&quot;, label = T, label.pos = &quot;in&quot;, width = 0.5,position = position_dodge(0.9), fill = &quot;語言能力&quot;,color = &quot;white&quot;,legend=&quot;none&quot;, palette = &quot;jco&quot;, x.text.angle = 30 ) ggbarplot(語言能力, x = &quot;語言能力&quot;, y = &quot;日文&quot;, label = T, label.pos = &quot;in&quot;, width = 0.5,position = position_dodge(0.9), fill = &quot;語言能力&quot;,color = &quot;white&quot;,legend=&quot;none&quot;, palette = &quot;jco&quot;, x.text.angle = 30 ) # 個案區分 個案區分 &lt;- 求職人資料 %&gt;% select(年,個案區分1,個案區分2,個案區分3, 個案區分4,個案區分5,個案區分6,個案區分7) A &lt;- pivot_longer(個案區分, cols=starts_with(&quot;個案區分&quot;), names_to = &quot;個案&quot;, values_to = &quot;區分&quot;, values_drop_na = FALSE) A$區分 &lt;- trimws(A$區分, which = c(&quot;both&quot;, &quot;left&quot;, &quot;right&quot;)) #分割個案區分 A$區分碼 &lt;- str_split_i(A$區分,&quot;-&quot;,1) A$區分名 &lt;- str_split_i(A$區分,&quot;-&quot;,2) A &lt;- A %&gt;% select(-2,-3) #A &lt;- A %&gt;% select(區分名) %&gt;% #A1 &lt;- A %&gt;% count(區分名) %&gt;% arrange(desc(n)) A1 &lt;- A %&gt;% count(年,區分名) %&gt;% arrange(desc(n)) 年_個案區分 &lt;- pivot_wider(A1, names_from = 年, values_from = n) %&gt;% select(區分名,&quot;2019&quot;,&quot;2020&quot;,&quot;2021&quot;,&quot;2022&quot;,&quot;2023&quot;) # 用table來呈現 A %&gt;% select(區分名) %&gt;% tbl_summary(label=區分名~&quot;個案身分名稱&quot;, sort = list(區分名 ~ &quot;frequency&quot;)) #bgxaqynxyo table { font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } #bgxaqynxyo thead, #bgxaqynxyo tbody, #bgxaqynxyo tfoot, #bgxaqynxyo tr, #bgxaqynxyo td, #bgxaqynxyo th { border-style: none; } #bgxaqynxyo p { margin: 0; padding: 0; } #bgxaqynxyo .gt_table { display: table; border-collapse: collapse; line-height: normal; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #bgxaqynxyo .gt_caption { padding-top: 4px; padding-bottom: 4px; } #bgxaqynxyo .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #bgxaqynxyo .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 3px; padding-bottom: 5px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #bgxaqynxyo .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bgxaqynxyo .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bgxaqynxyo .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #bgxaqynxyo .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #bgxaqynxyo .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #bgxaqynxyo .gt_column_spanner_outer:first-child { padding-left: 0; } #bgxaqynxyo .gt_column_spanner_outer:last-child { padding-right: 0; } #bgxaqynxyo .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #bgxaqynxyo .gt_spanner_row { border-bottom-style: hidden; } #bgxaqynxyo .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #bgxaqynxyo .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #bgxaqynxyo .gt_from_md > :first-child { margin-top: 0; } #bgxaqynxyo .gt_from_md > :last-child { margin-bottom: 0; } #bgxaqynxyo .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #bgxaqynxyo .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #bgxaqynxyo .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #bgxaqynxyo .gt_row_group_first td { border-top-width: 2px; } #bgxaqynxyo .gt_row_group_first th { border-top-width: 2px; } #bgxaqynxyo .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bgxaqynxyo .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #bgxaqynxyo .gt_first_summary_row.thick { border-top-width: 2px; } #bgxaqynxyo .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bgxaqynxyo .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #bgxaqynxyo .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #bgxaqynxyo .gt_last_grand_summary_row_top { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: double; border-bottom-width: 6px; border-bottom-color: #D3D3D3; } #bgxaqynxyo .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #bgxaqynxyo .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #bgxaqynxyo .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bgxaqynxyo .gt_footnote { margin: 0px; font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #bgxaqynxyo .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #bgxaqynxyo .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #bgxaqynxyo .gt_left { text-align: left; } #bgxaqynxyo .gt_center { text-align: center; } #bgxaqynxyo .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #bgxaqynxyo .gt_font_normal { font-weight: normal; } #bgxaqynxyo .gt_font_bold { font-weight: bold; } #bgxaqynxyo .gt_font_italic { font-style: italic; } #bgxaqynxyo .gt_super { font-size: 65%; } #bgxaqynxyo .gt_footnote_marks { font-size: 75%; vertical-align: 0.4em; position: initial; } #bgxaqynxyo .gt_asterisk { font-size: 100%; vertical-align: 0; } #bgxaqynxyo .gt_indent_1 { text-indent: 5px; } #bgxaqynxyo .gt_indent_2 { text-indent: 10px; } #bgxaqynxyo .gt_indent_3 { text-indent: 15px; } #bgxaqynxyo .gt_indent_4 { text-indent: 20px; } #bgxaqynxyo .gt_indent_5 { text-indent: 25px; } Characteristic N = 936,1381 個案身分名稱     失業給付者 38,690 (13%)     就保失業者 38,635 (13%)     一般資遣員工 37,444 (13%)     中高齡者 37,211 (13%)     一般求職者 37,169 (13%)     非自願離職 36,756 (13%)     青少年(十五歲至二十四歲) 26,148 (8.9%)     身心障礙者 5,055 (1.7%)     專案短期工作 3,348 (1.1%)     原住民 3,054 (1.0%)     工讀生 2,914 (1.0%)     高齡者 2,865 (1.0%)     其他 2,853 (1.0%)     中低收入戶 2,732 (0.9%)     因家庭因素退出勞動市場二年以上，重返職場之婦女 2,125 (0.7%)     長期失業者 2,029 (0.7%)     低收入戶 1,608 (0.5%)     公共服務 1,523 (0.5%)     獨力負擔家計者 1,144 (0.4%)     一般更生受保護人 1,011 (0.3%)     大專應屆畢業生 939 (0.3%)     已退休並領取老年年金或退休金者 878 (0.3%)     青年專案 878 (0.3%)     外籍配偶 865 (0.3%)     大陸配偶 756 (0.3%)     藥癮更生受保護人 613 (0.2%)     長期照顧人力(需證照) 521 (0.2%)     失業期間連續達3個月 475 (0.2%)     高中職應屆畢業生 468 (0.2%)     志願役退除役軍人 356 (0.1%)     職訓結訓學員 204 (&lt;0.1%)     關廠歇業資遣員工 174 (&lt;0.1%)     求職弱勢者 154 (&lt;0.1%)     弱勢青少年 153 (&lt;0.1%)     退出職場180日婦女 140 (&lt;0.1%)     屆退官兵 136 (&lt;0.1%)     家庭暴力被害人 106 (&lt;0.1%)     農民 98 (&lt;0.1%)     88水災受災者 94 (&lt;0.1%)     天然災害災後就業服務作業 87 (&lt;0.1%)     已退休尚未領取老年年金或退休金者 69 (&lt;0.1%)     大陸地區人民 68 (&lt;0.1%)     經濟弱勢戶 68 (&lt;0.1%)     特殊境遇家庭身分認定者 67 (&lt;0.1%)     遊民 45 (&lt;0.1%)     連結重點產業計畫青年 44 (&lt;0.1%)     連結重點產業計畫青年(特定學門) 40 (&lt;0.1%)     希望就業專案 37 (&lt;0.1%)     教育部提供即將畢業且願接受政府就業服務者 36 (&lt;0.1%)     參加過永續、多元及臨時工作津貼者 34 (&lt;0.1%)     非更生受保護藥癮者 26 (&lt;0.1%)     榮眷 25 (&lt;0.1%)     人口販運被害人 20 (&lt;0.1%)     公營事業民營化資遣員工 17 (&lt;0.1%)     漁民 14 (&lt;0.1%)     職業災害勞工 12 (&lt;0.1%)     犯罪被害人 11 (&lt;0.1%)     育嬰留職停薪及產假補充人力 11 (&lt;0.1%)     97 10 (&lt;0.1%)     其他機構轉介案 9 (&lt;0.1%)     15歲以上未滿18歲未就學未就業少年 8 (&lt;0.1%)     98年4月就博會求職者 8 (&lt;0.1%)     大陸失業台籍幹部 7 (&lt;0.1%)     性侵害被害人 5 (&lt;0.1%)     七二水災戶 4 (&lt;0.1%)     公共工程 3 (&lt;0.1%)     參加職業工會三個月以上之失業勞工 3 (&lt;0.1%)     艱困傳統產業勞工 3 (&lt;0.1%)     9506水災專案 2 (&lt;0.1%)     多元性別 2 (&lt;0.1%)     具精神疾病診斷(無身障證明者) 2 (&lt;0.1%)     傳統市場轉業者 2 (&lt;0.1%)     跨性別友善需求者 2 (&lt;0.1%)     9406水災專案 1 (&lt;0.1%)     九二一地震受災失業者 1 (&lt;0.1%)     中小企業人力協助計畫 1 (&lt;0.1%)     中途離校學生 1 (&lt;0.1%)     失智症者 1 (&lt;0.1%)     因應貿易自由化協助對象 1 (&lt;0.1%)     艾利風災受災戶 1 (&lt;0.1%)     家庭暴力及性侵害被害人 1 (&lt;0.1%)     農業就獎計畫 1 (&lt;0.1%)     Unknown 643,006 1 n (%) 年_個案區分 ## # A tibble: 83 × 6 ## 區分名 `2019` `2020` `2021` `2022` `2023` ## &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; ## 1 &lt;NA&gt; 142471 116259 119878 117129 147269 ## 2 中高齡者 7018 6984 6724 7186 9299 ## 3 一般求職者 8984 7596 6790 6136 7663 ## 4 就保失業者 7669 8447 7449 6587 8483 ## 5 失業給付者 7938 8370 7349 6648 8385 ## 6 一般資遣員工 7587 8014 7194 6492 8157 ## 7 非自願離職 7320 7936 7029 6355 8116 ## 8 青少年(十五歲至二十四歲) 4773 4080 5493 5443 6359 ## 9 身心障礙者 852 812 771 1058 1562 ## 10 原住民 496 452 506 674 926 ## # ℹ 73 more rows C &lt;- head(年_個案區分,30) #計算比例 C &lt;- A %&gt;% filter(年==&quot;2023&quot;) %&gt;% count(區分名) %&gt;% mutate(prop = percent(round(n/sum(n),3))) %&gt;% arrange(desc(n)) # 用table來呈現 C %&gt;% kbl(caption = &quot;個案區分統計一覽表&quot;) %&gt;% kable_classic(full_width = FALSE, html_font = &quot;Cambria&quot;) Table 6.1: 個案區分統計一覽表 區分名 n prop NA 147269 68.5% 中高齡者 9299 4.3% 就保失業者 8483 3.9% 失業給付者 8385 3.9% 一般資遣員工 8157 3.8% 非自願離職 8116 3.8% 一般求職者 7663 3.6% 青少年(十五歲至二十四歲) 6359 3.0% 身心障礙者 1562 0.7% 原住民 926 0.4% 高齡者 915 0.4% 因家庭因素退出勞動市場二年以上，重返職場之婦女 728 0.3% 專案短期工作 709 0.3% 其他 644 0.3% 中低收入戶 637 0.3% 工讀生 604 0.3% 長期失業者 429 0.2% 低收入戶 407 0.2% 已退休並領取老年年金或退休金者 372 0.2% 公共服務 336 0.2% 長期照顧人力(需證照) 250 0.1% 獨力負擔家計者 237 0.1% 一般更生受保護人 228 0.1% 外籍配偶 226 0.1% 大專應屆畢業生 225 0.1% 志願役退除役軍人 207 0.1% 青年專案 180 0.1% 大陸配偶 166 0.1% 藥癮更生受保護人 166 0.1% 失業期間連續達3個月 153 0.1% 退出職場180日婦女 140 0.1% 高中職應屆畢業生 93 0.0% 屆退官兵 89 0.0% 職訓結訓學員 67 0.0% 已退休尚未領取老年年金或退休金者 48 0.0% 連結重點產業計畫青年 44 0.0% 連結重點產業計畫青年(特定學門) 40 0.0% 關廠歇業資遣員工 35 0.0% 求職弱勢者 32 0.0% 天然災害災後就業服務作業 23 0.0% 家庭暴力被害人 21 0.0% 弱勢青少年 21 0.0% 農民 20 0.0% 大陸地區人民 18 0.0% 遊民 18 0.0% 非更生受保護藥癮者 17 0.0% 特殊境遇家庭身分認定者 13 0.0% 人口販運被害人 12 0.0% 參加過永續、多元及臨時工作津貼者 9 0.0% 榮眷 9 0.0% 經濟弱勢戶 9 0.0% 教育部提供即將畢業且願接受政府就業服務者 7 0.0% 公營事業民營化資遣員工 5 0.0% 漁民 5 0.0% 犯罪被害人 5 0.0% 公共工程 2 0.0% 具精神疾病診斷(無身障證明者) 2 0.0% 大陸失業台籍幹部 2 0.0% 職業災害勞工 2 0.0% 跨性別友善需求者 2 0.0% 15歲以上未滿18歲未就學未就業少年 1 0.0% 育嬰留職停薪及產假補充人力 1 0.0% 艱困傳統產業勞工 1 0.0% #graph D &lt;- A1 %&gt;% filter(年==&quot;2023&quot; &amp; !is.na(區分名)) %&gt;% head(30) ggbarplot(D, x = &quot;區分名&quot;, y = &quot;n&quot;, fill = &quot;區分名&quot;, # change fill color by cyl color = &quot;white&quot;, # Set bar border colors to white #palette = &quot;jco&quot;, # jco journal color palett. see ?ggpar x.text.angle = 30 , # Rotate vertically x axis texts show.legend = FALSE)+ theme(legend.position = &quot;none&quot;)+ theme(axis.text = element_text(face=&quot;bold&quot;,size = 5)) #xy-axis label size.. # 待加上額外文字 # 清結原因 求職人資料 %&gt;% count(清結原因1) ## # A tibble: 9 × 2 ## 清結原因1 n ## &lt;chr&gt; &lt;int&gt; ## 1 利用本部資訊就業 63861 ## 2 尚具求職需求 1366 ## 3 推薦成功 26540 ## 4 改利用其他管道 5661 ## 5 暫停就業 10940 ## 6 無法聯繫 7054 ## 7 系統自動關閉 13536 ## 8 自行就業 2608 ## 9 &lt;NA&gt; 2168 清結原因 &lt;- 求職人資料 %&gt;% group_by(年,清結原因1) %&gt;% summarise(count=n()) ## `summarise()` has grouped output by &#39;年&#39;. You can override using the `.groups` ## argument. 清結原因$清結原因1 &lt;- factor(清結原因$清結原因1, levels=c(&quot;推薦成功&quot;,&quot;利用本部資訊就業&quot;, &quot;自行就業&quot;,&quot;改利用其他管道&quot;,&quot;暫停就業&quot;, &quot;無法聯繫&quot;,&quot;系統自動關閉&quot;,&quot;尚具求職需求&quot;, NA)) D &lt;- 清結原因 %&gt;% filter(年==&quot;2023&quot; &amp; !is.na(清結原因1)) ggbarplot(D, x = &quot;清結原因1&quot;, y = &quot;count&quot;, label = T, label.pos = &quot;in&quot;, width = 0.5,position = position_dodge(0.9), fill = &quot;年&quot;,color = &quot;white&quot;,ylim=c(0,18000), palette = &quot;jco&quot;, x.text.angle = 30 ) #兵役 A &lt;- 求職人資料 %&gt;% group_by(年,兵役) %&gt;% summarise(count=(n())) %&gt;% mutate(prop = percent(round(count/sum(count),3))) ## `summarise()` has grouped output by &#39;年&#39;. You can override using the `.groups` ## argument. p &lt;- ggplot(A, aes(兵役, count, label = prop,fill=兵役))+ labs(x = NULL, y = NULL) # Hide axis label p + geom_bar(stat = &quot;identity&quot;) + ggtitle(&quot;兵役狀態&quot;)+ geom_text(aes(label = prop),vjust=&quot;outward&quot;)+ facet_wrap(.~年) # 希望待遇與前次工資 求職人資料$希望待遇 &lt;- as.integer(求職人資料$希望待遇) 求職人資料$前次工作薪資 &lt;- as.integer(求職人資料$前次工作薪資) B &lt;- 求職人資料 %&gt;% select(年,教育程度,希望待遇,前次工作薪資, 年齡分組1,清結原因1) B$希望待遇 &lt;- ifelse(B$希望待遇!=0,B$希望待遇,NA) B$前次工作薪資 &lt;- ifelse(B$前次工作薪資!=0,B$前次工作薪資,NA) ggplot(B, aes(x=教育程度, y=希望待遇))+ geom_boxplot(outliers = FALSE,na.rm = TRUE) + stat_summary(fun=mean, geom=&quot;point&quot;, shape=5, size=3)+ stat_summary(aes(label=round(..y..,0)), fun.y=mean, geom=&quot;text&quot;, size=3, vjust = -0.5) ## Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0. ## ℹ Please use the `fun` argument instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. ## Warning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0. ## ℹ Please use `after_stat(y)` instead. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. ## Warning: Removed 106624 rows containing non-finite outside the scale range ## (`stat_summary()`). ## Removed 106624 rows containing non-finite outside the scale range ## (`stat_summary()`). # 薪資落差 C &lt;- na.omit(B) #去掉NA，使可以比較薪資差異 薪資落差 &lt;- C %&gt;% mutate(薪資差異=希望待遇-前次工作薪資) #找出異常值 out.薪資差異 &lt;- boxplot.stats(薪資落差$薪資差異)$out out_ind &lt;- which(薪資落差$薪資差異 %in% c(out.薪資差異)) D&lt;- 薪資落差[-out_ind, ] ggplot(D, aes(x=教育程度, y=薪資差異))+ geom_boxplot(outliers = T) + stat_summary(fun=mean, geom=&quot;point&quot;, shape=5, size=3)+ stat_summary(aes(label=round(..y..,0)), fun.y=mean, geom=&quot;text&quot;, size=3, vjust = -0.5) #工作地點與居住行政區 #居住地點分布 F &lt;- 求職人資料 %&gt;% select(年,居住行政區) %&gt;% filter(str_detect(居住行政區, &quot;市&quot;)|str_detect(居住行政區, &quot;縣&quot;)) F$居住市 &lt;- str_sub(F$居住行政區,1,2) #居住市來源 G1 &lt;- F %&gt;% group_by(居住市) %&gt;% summarise(人數=n()) %&gt;% arrange(desc(人數)) %&gt;% mutate(prop = round(人數/sum(人數),3)) %&gt;% filter(prop&gt;0.001) G1$居住市 ## [1] &quot;高雄&quot; &quot;屏東&quot; &quot;台南&quot; &quot;台中&quot; &quot;嘉義&quot; &quot;新北&quot; &quot;桃園&quot; &quot;彰化&quot; &quot;雲林&quot; &quot;台北&quot; ## [11] &quot;台東&quot; &quot;新竹&quot; #年齡分組A G1$居住市&lt;- factor(G1$居住市, levels=c(&quot;高雄&quot;,&quot;屏東&quot;,&quot;台南&quot;,&quot;嘉義&quot;,&quot;雲林&quot;,&quot;彰化&quot;, &quot;台中&quot;,&quot;新竹&quot;,&quot;新北&quot;, &quot;桃園&quot;,&quot;台北&quot;, &quot;台東&quot;)) ggplot(G1,aes(x=居住市,y = 人數,fill = 居住市)) + geom_col(,show.legend = FALSE) + geom_text(aes(label = 人數), vjust=-0.5, position=position_dodge(width=1), size=3) + xlab(&quot;居住城市&quot;) +ylab(&quot;人數&quot;) + ggtitle(&quot;求職人員居住城市統計一覽表&quot;) F &lt;- F %&gt;% filter(居住市==&quot;高雄&quot;) F$居住區 &lt;-str_split_i(F$居住行政區,&quot;市&quot;,2) G2 &lt;- F %&gt;% group_by(居住區) %&gt;% summarise(人數=n()) %&gt;% arrange(desc(人數)) %&gt;% mutate(prop = round(人數/sum(人數),3)) %&gt;% filter(prop&gt;0.001) G2 &lt;- head(G2,10) G2$居住區&lt;- factor(G2$居住區, levels=c(&quot;鳳山區&quot;, &quot;三民區&quot;, &quot;楠梓區&quot;, &quot;左營區&quot;, &quot;前鎮區&quot; , &quot;苓雅區&quot;, &quot;小港區&quot;, &quot;大寮區&quot;, &quot;鼓山區&quot;,&quot;岡山區&quot;)) ggplot(G2,aes(x=居住區,y = 人數,fill = 居住區)) + geom_col(show.legend = FALSE) + geom_text(aes(label = 人數), vjust=-0.5, position=position_dodge(width=1), size=3,color=&quot;darkred&quot;) + xlab(&quot;居住城市&quot;) +ylab(&quot;人數&quot;) + geom_text(aes(label = percent(prop,0.1)), vjust=2, position=position_dodge(width=1), size=3) + ggtitle(&quot;求職人員高雄市居住區域統計一覽表&quot;) "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
